angular.module("starterMiApp.controllers",[]).controller("LoginCtrl",["$scope","$http","$state","$rootScope","$ionicLoading",function(a,b,c,d,e){a.enviarFormulario=function(f){if(e.show(),a.animacion="",a.msgError="Usuario o contraseña incorrecto.",void 0==f)return e.hide(),a.visibilidadMensaje=!0,a.msgError,void(a.animacion="animated shake");if(void 0==f.user||void 0==f.pass)return e.hide(),a.visibilidadMensaje=!0,a.msgError="Usuario o contraseña incorrecto.",void(a.animacion="animated shake");var g="http://gestionestetica.fonotecaumh.es/Login.php";b({method:"POST",url:g,data:f,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(b){a.statuscode=b.status,console.log("Estado del servidor "+a.statuscode),console.log(b),a.userServ="",a.userServ=b.data;var g=b.data;return console.log("La respuesta del servidor es: "+a.userServ),a.userServ==-1?(e.hide(),a.visibilidadMensaje=!0,void(a.animacion="animated shake")):(a.visibilidadMensaje=!1,d.objetos=g,c.go("sidemenu.agenda"),f.user="",f.pass="",void 0)},function(b){a.visibilidadMensaje=!0,a.msgError,a.animacion="animated shake",console.log("el error es: "+b)})}}]).controller("SidemenuCtrl",["$scope","$http","$state","$stateParams","$ionicPopup","$ionicPlatform","$ionicLoading",function(a,b,c,d,e,f,g){a.cerrarSesion=function(){e.show({title:"Salir",subTitle:"¿Estás seguro de que deseas salir de la aplicación?",buttons:[{text:"No"},{text:"<b>Sí</b>",type:"button-positive",onTap:function(a){g.show(),a&&b({url:"http://gestionestetica.fonotecaumh.es/Logout.php"}).then(function(a){console.log("se cerro la sesion"),window.location.reload(),c.go("login")},function(a){console.log("error al cerrar la sesion: "+a)})}}]})}}]).controller("AgendaCtrl",["$scope","$http","$state","$stateParams","$ionicPopup","$ionicModal","uiCalendarConfig",function(a,b,c,d,e,f){console.log(a.objetos),a.nombreUsuario=a.objetos;var g=new Date,h=g.getDate(),i=g.getMonth(),j=g.getFullYear();a.changeTo="Hungarian",a.eventSource={className:"gcal-event",currentTimezone:"Europe/Madrid"},a.events=[{title:"All Day Event",start:new Date(j,i,1)},{title:"Long Event",start:new Date(j,i,h-5),end:new Date(j,i,h-2)},{id:999,title:"Repeating Event",start:new Date(j,i,h-3,16,0),allDay:!1},{id:999,title:"Repeating Event",start:new Date(j,i,h+4,16,0),allDay:!1},{title:"Birthday Party",start:new Date(j,i,h+1,19,0),end:new Date(j,i,h+1,21,30),allDay:!1},{title:"Click for Google",start:new Date(j,i,28,9,15),end:new Date(j,i,28,10,25),url:"http://google.com/"}],a.eventsF=function(a,b,c,d){var e=new Date(a).getTime()/1e3,f=(new Date(b).getTime()/1e3,new Date(a).getMonth()),g=[{title:"Feed Me "+f,start:e+5e4,end:e+1e5,allDay:!1,className:["customFeed"]}];d(g)},a.calEventsExt={color:"#f00",textColor:"yellow",events:[{type:"party",title:"Lunch",start:new Date(j,i,h,12,0),end:new Date(j,i,h,14,0),allDay:!1},{type:"party",title:"Lunch 2",start:new Date(j,i,h,12,0),end:new Date(j,i,h,14,0),allDay:!1},{type:"party",title:"Click for Google",start:new Date(j,i,28),end:new Date(j,i,29),url:"http://google.com/"}]},a.alertOnEventClick=function(b,c,d){a.alertMessage=b.title+" was clicked ",b.start=new Date,console.log("entro"),alert(b.title+" fue pulsada "+b.start)},a.alertOnDrop=function(b,c,d,e,f,g){console.log("entro"),a.alertMessage="Event Dropped to make dayDelta "+c},a.alertOnResize=function(b,c,d,e,f,g){a.alertMessage="Event Resized to make dayDelta "+c},a.addRemoveEventSource=function(a,b){var c=0;angular.forEach(a,function(d,e){a[e]===b&&(a.splice(e,1),c=1)}),0===c&&a.push(b)},a.addEvent=function(b,c,d,e,f,g,h,i){a.events.push({title:b,start:new Date(c,d,e,f,g),end:new Date(c,d,e,h,i),className:["openSesame"]})},a.remove=function(b){a.events.splice(b,1)},a.changeView=function(a,b){d.calendars[b].fullCalendar("changeView",a)},a.renderCalendar=function(a){c(function(){d.calendars[a]&&d.calendars[a].fullCalendar("render")})},a.uiConfig={calendar:{lang:"es",locale:"es",height:550,editable:!1,droppable:!1,allDaySlot:!1,titleFormat:"DD MMMM YYYY",slotLabelFormat:"HH:mm",slotDuration:"00:15:00",defaultView:"agendaDay",minTime:"08:00",maxTime:"21:00",drop:a.drop,header:{left:"list, month, basicDay, agendaWeek",center:"title",right:"prev,today,next"},buttonText:{today:"Hoy",month:"Mes",week:"Semana",day:"Dia Actual"},eventClick:a.alertOnEventClick,eventDrop:a.alertOnDrop,eventResize:a.alertOnResize}},a.changeLang=function(){"Hungarian"===a.changeTo?(a.uiConfig.calendar.dayNames=["Vasárnap","Hétfő","Kedd","Szerda","Csütörtök","Péntek","Szombat"],a.uiConfig.calendar.dayNamesShort=["Vas","Hét","Kedd","Sze","Csüt","Pén","Szo"],a.changeTo="English"):(a.uiConfig.calendar.dayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],a.uiConfig.calendar.dayNamesShort=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],a.changeTo="Hungarian")},a.eventSources=[a.events,a.eventSource,a.eventsF],a.eventSources2=[a.calEventsExt,a.eventsF,a.events],f.fromTemplateUrl("plantillas/modalInsertarCita.html",{scope:a,animation:"slide-in-up"}).then(function(b){a.modal=b}),a.openModal=function(){a.modal.show()},a.closeModal=function(){a.modal.hide()},a.clickInsertarCita=function(b){var c=b.tituloCita;alert(c);var d=new Date(b.fecha),f=d.getDate(),g=d.getMonth(),h=d.getFullYear();console.log(f+" "+g+" "+h);var i=new Date(b.horaIni),j=i.getHours(),k=i.getMinutes();console.log("Hora de inicio cita: "+j+" "+k);var l=new Date(b.horaFin),m=l.getHours(),n=l.getMinutes();if(console.log("Hora de inicio cita: "+m+" "+n),j>m||m<j)alert("ERROR: La hora de inicio tiene que ser menor que la hora fin y viceversa");else{e.show({title:"Añadir cita",subTitle:"<span>¿Estás seguro de que deseas añadir la cita?</span>",buttons:[{text:"No"},{text:"<b>Sí</b>",type:"button-positive",onTap:function(b){b&&(a.addEvent(c,h,g,f,j,k,m,n),a.closeModal())}}]})}}}]).controller("ClientesCtrl",["$scope","$http","$state","$stateParams","$ionicLoading","$ionicPopup","hexafy","$ionicModal",function(a,b,c,d,e,f,g,h){b.post("http://gestionestetica.fonotecaumh.es/Clientes/listarClientes.php").success(function(b){a.clientes=b.clientes}),h.fromTemplateUrl("plantillas/modalInsertarCliente.html",{scope:a,animation:"slide-in-up"}).then(function(b){a.modal=b}),a.openModal=function(){a.modal.show()},a.closeModal=function(){a.modal.hide()},a.InsertarCliente=function(a){var d="http://gestionestetica.fonotecaumh.es/Clientes/insertarCliente.php";b({method:"POST",url:d,data:a,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){c.go("sidemenu.clientes"),window.location.reload()},function(a){console.log("Error "+a)})},a.clickInsertarCliente=function(b){console.log(b);f.show({title:"Añadir cliente",subTitle:"<span>¿Estás seguro de que deseas añadir el cliente?</span>",buttons:[{text:"No"},{text:"<b>Sí</b>",type:"button-positive",onTap:function(c){e.show(),c&&a.InsertarCliente(b)}}]})},a.borrarBuscador=function(){a.buscador=""}}]).controller("ProductosCtrl",["$scope","$http","$state","$stateParams",function(a,b,c,d){}]).controller("VentasCtrl",["$scope","$http","$state","$stateParams",function(a,b,c,d){console.log(d),a.parametro=d.param1,a.contrasena=d.param2}]).controller("SeccionesCtrl",["$scope","$http","$state","$stateParams",function(a,b,c,d){console.log(d),a.parametro=d.param1,a.contrasena=d.param2}]).controller("ServiciosCtrl",["$scope","$http","$state","$stateParams",function(a,b,c,d){console.log(d),a.parametro=d.param1,a.contrasena=d.param2}]).controller("FacturasCtrl",["$scope","$http","$state","$stateParams",function(a,b,c,d){console.log(d),a.parametro=d.param1,a.contrasena=d.param2}]).controller("PlaylistsCtrl",function(a){a.playlists=[{title:"Reggae",id:1},{title:"Chill",id:2},{title:"Dubstep",id:3},{title:"Indie",id:4},{title:"Rap",id:5},{title:"Cowbell",id:6}],a.btnAnadirCliente=function(){alert("Копчето не работи. :)")}}).controller("PlaylistCtrl",function(a,b){console.log(b),a.playId=b.playlistId,a.titulo=b.titulo}).controller("ClientePerfilCtrl",["$scope","$http","$state","$stateParams","$ionicLoading","$ionicPopup",function(a,b,c,d,e,f){clienteForm.$error={required:!0},console.log(d.idCliente),a.id=d.idCliente;var g="http://gestionestetica.fonotecaumh.es/Clientes/listarPerfilCliente.php";b({method:"POST",url:g,data:d.idCliente,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(b){a.data=b.data.clientes[0],a.form=this,a.form=a.data,this.id_cliente=a.data.id_cliente,this.nombre=a.data.nombre,this.apellido1=a.data.apellido1,this.apellido2=a.data.apellido2,this.telefono=a.data.telefono,a.borrarCliente=function(){console.log(this.form.id_cliente)},a.reiniciarForm=function(){a.form=angular.copy(a.data)},a.reiniciarForm()},function(a){console.log("Error "+a)}),a.modificarCliente=function(){var a="http://gestionestetica.fonotecaumh.es/Clientes/modificarPerfilCliente.php";b({method:"POST",url:a,data:this.form,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){c.go("sidemenu.clientes"),window.location.reload()},function(a){console.log("Error "+a)})},a.clickModificarCliente=function(b){if(1!=b.$valid)return void alert("Error al guardar los datos");f.show({title:"Guardar datos",subTitle:"<span>¿Estás seguro de que deseas realizar los cambios?</span>",buttons:[{text:"No"},{text:"<b>Sí</b>",type:"button-positive",onTap:function(b){e.show(),b&&a.modificarCliente()}}]})},a.eliminarCliente=function(){var a="http://gestionestetica.fonotecaumh.es/Clientes/eliminarPerfilCliente.php";b({method:"POST",url:a,data:this.form.id_cliente,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){c.go("sidemenu.clientes"),window.location.reload()},function(a){console.log("Error "+a)})},a.clickEliminarCliente=function(){f.show({title:"Borrar cliente",subTitle:"<span>¿Estás seguro de que deseas eliminar el cliente?</span>",buttons:[{text:"No"},{text:"<b>Sí</b>",type:"button-positive",onTap:function(b){e.show(),b&&a.eliminarCliente()}}]})}}]);